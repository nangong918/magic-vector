<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.minio.mapper.OssMapper">

    <sql id="table">
        oss
    </sql>

    <sql id="columns">
        id, bucket_name, object_name
    </sql>

    <insert id="insert">
        insert into
        <include refid="table"/>
        (
        <include refid="columns"/>
        )
        values(
        #{ossDo.id}, #{ossDo.bucketName}, #{ossDo.objectName}
        )
    </insert>
    <insert id="insertBatch">
        <if test="list != null and list.size() > 0">
            insert into
            <include refid="table"/>
            (
            <include refid="columns"/>
            )
            values
            <foreach item="item" index="index" collection="list" separator="," open="(" close=")">
                (
                #{item.id}, #{item.bucketName}, #{item.objectName}
                )
            </foreach>
        </if>
    </insert>

    <update id="update">
        update
        <include refid="table"/>
        set
        <if test="ossDo.id != null">
            id = #{ossDo.id},
        </if>
        <if test="ossDo.bucketName != null">
            bucket_name = #{ossDo.bucketName},
        </if>
        <if test="ossDo.objectName != null">
            object_name = #{ossDo.objectName},
        </if>
        where id = #{ossDo.id}
    </update>
    <update id="updateBatch">
        <if test="list != null and list.size() > 0">
            <foreach collection="list" item="ossDo" separator=";">
                update
                <include refid="table"/>
                set
                <if test="ossDo.id != null">
                    id = #{ossDo.id},
                </if>
                <if test="ossDo.bucketName != null">
                    bucket_name = #{ossDo.bucketName},
                </if>
                <if test="ossDo.objectName != null">
                    object_name = #{ossDo.objectName},
                </if>
                where id = #{ossDo.id}
            </foreach>
        </if>
    </update>

    <delete id="delete">
        delete from
        <include refid="table"/>
        where id = #{id}
    </delete>
    <delete id="deleteByObjectNameAndBucketName">
        delete from
        <include refid="table"/>
        where object_name = #{objectName} and bucket_name = #{bucketName}
    </delete>
    <delete id="deleteBatch">
        <if test="list != null and list.size() > 0">
            delete from
            <include refid="table"/>
            where id in
            <foreach item="item" index="index" collection="list" separator="," open="(" close=")">
                #{item}
            </foreach>
        </if>
    </delete>

    <select id="getById" resultType="com.minio.domain.Do.OssDo">
        select
        <include refid="columns"/>
        from
        <include refid="table"/>
        where id = #{id}
    </select>
    <select id="getByObjectNameAndBucketName" resultType="com.minio.domain.Do.OssDo">
        select
        <include refid="columns"/>
        from
        <include refid="table"/>
        where object_name = #{objectName} and bucket_name = #{bucketName}
    </select>
    <select id="getByIds" resultType="com.minio.domain.Do.OssDo">
        <if test="list != null and list.size() > 0">
            select
            <include refid="columns"/>
            from
            <include refid="table"/>
            where id in
            <foreach item="item" index="index" collection="list" separator="," open="(" close=")">
                #{item}
            </foreach>
        </if>
    </select>
</mapper>